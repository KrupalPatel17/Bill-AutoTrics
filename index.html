<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>


    <link href="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.js"></script>

    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.2.0/fonts/remixicon.css" rel="stylesheet">


    <title>Document</title>
    <style>
        .contai {
            border: 2px solid black;
            border-radius: 12px;
            width: 90%;
        }

        #logo {
            margin-right: 100px;
            width: 93%;
            overflow: hidden;
        }

        td {
            border: none;
        }

        #headerTitle {
            width: 30%;
        }

        .header input {
            border: none;
        }

        .header2 {
            display: flex;
        }

        #Lline {
            border: none;
            width: 38%;
            margin-left: 20px;
        }

        #Htext {
            margin-top: 0px;
            font-size: 140%;
            font-family: 'Times New Roman', Times, serif;
        }

        #Rline {
            border: none;
            width: 38%;
        }

        .header2 hr {
            height: 10px;
            background-color: #000000;
            border: none;
        }

        .add p {
            margin-bottom: 10px;
        }

        .add {
            border-bottom: 2px solid black;
        }

        .info input {
            border: none;
            border-bottom: 1px solid black;
        }

        #mr {
            width: 60%;
        }

        #date {
            width: 20%;
        }

        #adde {
            width: 66%;
        }

        #km {
            width: 21%;
        }

        #regno {
            width: 30%;
        }

        #model {
            width: 29%;
        }

        #cont {
            width: 18%;
        }

        .handsontable td {
            font-size: 16px;
        }

        .bottom {
            display: flex;
            border-top: 2px solid black;
        }

        #bottomLeft input {
            border: none;
            border-bottom: 1px solid black;
        }

        #bottomLeft {
            text-align: left;
        }

        #printButton {
            width: 13%;
            height: 7%;
            color:#e21517;
            background-color:#010101;
            font-size: 20px;
            font-weight: bold;
            border: 2px solid#4a4a4a;
            border-radius: 10px;
            margin-top: 20px;
            transition: all ease 0.5s;
            box-shadow: 1px 2px 4px black;
        }

        #printButton:hover {
            transform: scale(1.10);
            color:#010101;
            background-color:#e21517;
            font-weight: bold;
            border: 2px solid#7a7a7a;
            box-shadow: 2px 2px 7px black;

        }

        @media print {
            #logo {
                width: 90%;
                overflow: hidden;
            }

            #headerTitle {
                font-size: 10px;
            }

            #Htext {
                margin-top: 4px;
                font-size: 90%;
            }

            #Rline,
            #Lline {
                border: none;
                width: 35%;
            }

            #Lline {
                margin-left: 25px;
            }

            .header2 hr {
                height: 5px;
                background-color: #5f5f5f;
                border: none;
            }

            .add p {
                font-size: 70%;

            }

            #mr {
                width: 50%;
            }

            #date {
                width: 20%;
            }

            #adde {
                width: 60%;
            }

            #km {
                width: 22%;
            }

            #regno {
                width: 25%;
            }

            #model {
                width: 23%;
            }

            #cont {
                width: 16%;
            }

            .tbl {
                margin-top: 20px;
                width: 100%;
            }

            .handsontable {
                width: 100% !important;
            }
        }
    </style>
</head>

<body>
    <center>
        <div class="contai mt-4 text-center mb-3">
            <table class="header mt-2">
                <tr>
                    <td class="col d-flex justify-content-end" id="logo"><img src="logo2.jpg" alt="" width="45%"></td>
                    <td id="headerTitle" class="text-left"><b>ESTIMATE</b> <input type="text" size="10"><br>
                        <b> NO.:</b> <input type="text" size="15">
                    </td>
                </tr>
            </table>

            <div class="header2">

                <div id="Lline">
                    <hr>
                </div>
                <div id="Htext"><b> <i>&nbsp &nbspMulticar Workshop &nbsp &nbsp </i></b></div>
                <div id="Rline">
                    <hr>
                </div>
            </div>

            <div class="add">
                <p>BLOCK No. 126, .Nr Green Orion, Opp. CNG Pump, Canal Road, Jahangirabad, Surat-395 005. <br>
                    M.: +91 99989 63841 | E-mail : autotrics2021@gmail.com</p>
            </div>

            <div class="info mb-2">
                MR./Mrs/M/s. <input type="text" id="mr"> Date : <input type="date" id="date"><br>
                Add. <input type="text" id="adde"> KM.: <input type="" name="" id="km"> <br>
                Reg No. <input type="text" name="" id="regno"> Model <input type="text" name="" id="model"> Cont No.:
                <input type="text" id="cont">
                <div class="tbl">
                </div>
                <div id="example1" class="hot mt-2"></div>
            </div>

            <div class="bottom mb-2">
                <div id="bottomLeft">
                    <b>&nbsp Remark:</b><input type="text" name="" id="" size="50"><br>
                    <input type="text" name="" id="" size="59"><br>
                    <input type="text" name="" id="" size="59"><br>
                    <input type="text" name="" id="" size="59"><br>
                    &nbsp Customer Sing. <input type="text" name="" id="" size="10"> &nbsp &nbsp <b>Tanks for Visit</b>
                </div>

                <div class="rightBottom"><b>
                        <h4>For, AUTOTRICS</h4>
                    </b><br><br><br>
                    Authorised Signature

                </div>
            </div>
        </div>

        <button id="printButton" onclick="printPage()" class="mb-4">Print <i class="ri-printer-fill"></i></button>


    </center>

    <script>
        const container = document.querySelector('#example1');
        const data = [
            ['Sr.No.', 'DESCRIPTION', 'Qty.', 'Rate', 'Amount'],
            ['', '', '', '', ''],
            ['', '', '', '', ''],
            ['', '', '', '', ''],
            ['', '', '', '', ''],
            ['', '', '', '', ''],
            ['', '', '', '', ''],
            ['', '', '', '', ''],
            ['', '', '', '', ''],
            ['', '', '', '', ''],
            ['', '', '', '', ''],
            ['', '', '', '', ''],
            ['', '', '', '', ''],
            ['', '', '', '', ''],
            ['', '', '', '', ''],
            ['', '', '', '', ''],
            ['', '', '', '', ''],
            ['', '', '', '', ''],
            ['', '', '', '', ''],
            ['', '', '', '', ''],
            ['', '', '', '', ''],
            ['Rupees', '', '', 'TOTAL', ''],
        ];

        const hot = new Handsontable(container, {
            data,
            startRows: 5,
            startCols: 5,
            height: 'auto',
            width: '100%',
            autoWrapRow: true,
            autoWrapCol: true,
            licenseKey: 'non-commercial-and-evaluation',
            colWidths: [80, 250, 100, 100, 130], // Adjust column widths as needed
            afterChange: (changes, source) => {
                if (source === 'edit') { // Only trigger on user edits
                    changes.forEach(([row, col, oldValue, newValue]) => {
                        if (col === 2 || col === 3) { // If change is in Qty or Rate column
                            const qty = hot.getDataAtCell(row, 2);
                            const rate = hot.getDataAtCell(row, 3);
                            const amount = qty * rate;
                            hot.setDataAtCell(row, 4, amount); // Update Amount column

                            // Recalculate total amount
                            let totalAmount = 0;
                            hot.getData().forEach((rowData, index) => {
                                if (index !== hot.countRows() - 1) { // Exclude the last row for total
                                    totalAmount += parseFloat(rowData[4]) || 0;
                                }
                            });
                            hot.setDataAtCell(hot.countRows() - 1, 4, totalAmount); // Update total in last row
                        }
                    });
                }
            }
        });
    </script>

    <script>
        function getCurrentDateTime() {
            const now = new Date();
            const year = now.getFullYear();
            let month = now.getMonth() + 1;
            let day = now.getDate();
            let hours = now.getHours();
            let minutes = now.getMinutes();

            // Add leading zeros if needed
            month = month < 10 ? '0' + month : month;
            day = day < 10 ? '0' + day : day;
            hours = hours < 10 ? '0' + hours : hours;
            minutes = minutes < 10 ? '0' + minutes : minutes;

            return `${year}-${month}-${day}T${hours}:${minutes}`; // Date and time format: YYYY-MM-DDTHH:MM
        }

        // Set current date and time in the date input element
        const dateInput = document.querySelector('input[type="date"]');
        dateInput.value = getCurrentDateTime().slice(0, 10);
    </script>

    <script>

        function printPage() {

            document.getElementById("printButton").style.visibility = "hidden";
            window.print();
            setTimeout(function () {
                document.getElementById("printButton").style.visibility = "visible";
            }, 100);
        }

    </script>


</body>

</html>